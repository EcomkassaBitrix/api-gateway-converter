# eKomKassa Gateway - Postman Collection

–ö–æ–ª–ª–µ–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API eKomKassa Gateway.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ Postman
2. –ù–∞–∂–º–∏—Ç–µ `Import` –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
3. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã:
   - `eKomKassa-Gateway.postman_collection.json` - –∫–æ–ª–ª–µ–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
   - `eKomKassa-Gateway.postman_environment.json` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ —Å—Å—ã–ª–∫—É

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤ –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ `Raw text` –≤ Postman.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ `eKomKassa Gateway Environment` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è |
|------------|----------|-----------------|
| `base_url` | URL –≤–∞—à–µ–≥–æ Gateway | `https://ekomkassa-gateway.example.com` |
| `login` | –õ–æ–≥–∏–Ω –¥–ª—è eKomKassa | `your_login` |
| `password` | –ü–∞—Ä–æ–ª—å –¥–ª—è eKomKassa | `your_password` |
| `group_code` | –ö–æ–¥ –≥—Ä—É–ø–ø—ã –ö–ö–¢ | `700` |
| `auth_token` | –¢–æ–∫–µ–Ω (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | - |
| `receipt_uuid` | UUID —á–µ–∫–∞ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | - |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–ø—Ä–æ—Å: `Authentication > Get Auth Token`

- –¢–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `auth_token`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–ø—Ä–æ—Å: `Receipt > Create Receipt (Income)`

- UUID —á–µ–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `receipt_uuid`
- –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —á–µ–∫–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–ø—Ä–æ—Å: `Status > Get Receipt Status`

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç UUID –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Ñ–∏—Å–∫–∞–ª–∏–∑–∞—Ü–∏–∏

## üìã –°–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤

### üîê Authentication
- **Get Auth Token** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API

### üßæ Receipt
- **Create Receipt (Income)** - —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–∞ –ø—Ä–∏—Ö–æ–¥–∞ (–ø—Ä–æ–¥–∞–∂–∞)
- **Create Receipt (Income Return)** - —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∞
- **Create Receipt (Simple Format)** - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–ø—Ä—è–º–∞—è –ø—Ä–æ–∫—Å–∞—Ü–∏—è)

### üìä Status
- **Get Receipt Status** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —á–µ–∫–∞ (–∞–≤—Ç–æ UUID)
- **Get Receipt Status (Manual UUID)** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å —Ä—É—á–Ω—ã–º –≤–≤–æ–¥–æ–º UUID

### üõ†Ô∏è Health & Admin
- **Health Check** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
- **Admin Login** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- **Get Logs** - –ø–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Get Request Logs** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ `Get Auth Token` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç:

```javascript
if (pm.response.code === 200) {
    var jsonData = pm.response.json();
    if (jsonData.Status === 'Success' && jsonData.Data && jsonData.Data.AuthToken) {
        pm.environment.set('auth_token', jsonData.Data.AuthToken);
    }
}
```

### –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ UUID —á–µ–∫–∞

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —á–µ–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç:

```javascript
if (pm.response.code === 200) {
    var jsonData = pm.response.json();
    if (jsonData.Status === 'Success' && jsonData.Data && jsonData.Data.ReceiptId) {
        pm.environment.set('receipt_uuid', jsonData.Data.ReceiptId);
    }
}
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤

### –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```json
{
  "Status": "Success",
  "Data": {
    "AuthToken": "eyJ0eXAiOiJKV1QiLCJhbGc...",
    "ExpirationDateUtc": "2099-12-31T23:59:59"
  }
}
```

### –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–∞
```json
{
  "Status": "Success",
  "Data": {
    "ReceiptId": "105134235"
  }
}
```

### –°—Ç–∞—Ç—É—Å —á–µ–∫–∞ (–≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ)
```json
{
  "Status": "Success",
  "Data": {
    "StatusCode": 0,
    "StatusName": "NEW",
    "StatusMessage": "–ó–∞–ø—Ä–æ—Å –Ω–∞ —á–µ–∫ –ø–æ–ª—É—á–µ–Ω",
    "ReceiptId": "105134235",
    "Device": null
  }
}
```

### –°—Ç–∞—Ç—É—Å —á–µ–∫–∞ (–æ–±—Ä–∞–±–æ—Ç–∞–Ω)
```json
{
  "Status": "Success",
  "Data": {
    "StatusCode": 1,
    "StatusName": "PROCESSED",
    "StatusMessage": "–ß–µ–∫ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∫–∞—Å—Å–µ",
    "ReceiptId": "105134235",
    "Device": {
      "DeviceId": "0000111122223333",
      "FN": "9999888877776666",
      "FDN": "12345",
      "FPD": "1234567890",
      "OfdReceiptUrl": "https://check.ofd.ru/..."
    }
  }
}
```

### –û—à–∏–±–∫–∞
```json
{
  "Status": "Failed",
  "Error": {
    "Code": 401,
    "Message": "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞. –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
  }
}
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ API

1. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å: `Admin > Admin Login`
2. –ü–æ–ª—É—á–∏—Ç–µ –ª–æ–≥–∏: `Admin > Get Logs` –∏–ª–∏ `Admin > Get Request Logs`

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `{{base_url}}/request-logs`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** - –Ω–µ –Ω—É–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é
2. **UUID —á–µ–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** - –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ç—É—Å
3. **GroupCode –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 700** - –∏–∑–º–µ–Ω–∏—Ç–µ –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –¥—Ä—É–≥–æ–π
4. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (login: `admin`, password: `GatewayEcomkassa`)

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: —Å–º. `flask-deployment/app.py`
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `{{base_url}}/`
- –õ–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤: `{{base_url}}/request-logs`
- Health check: `{{base_url}}/health`

## üêõ –ü—Ä–æ–±–ª–µ–º—ã?

–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `base_url` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω: `curl {{base_url}}/health`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω: –∑–∞–ø—É—Å—Ç–∏—Ç–µ `Get Auth Token` –∑–∞–Ω–æ–≤–æ
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: `Get Request Logs` –∏–ª–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
